<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>API Fetch</h2>
    <ol id="fetch"></ol>



    <script>
        const $fetch = document.getElementById("fetch"),
            $fragment = document.createDocumentFragment();


        fetch("https://jsonplaceholder.typicode.com/users")
            .then((res) => (res.ok ? res.json() : Promise.reject(res)))
            .then((json) => {
                // console.log(json)
                json.forEach((el) => {
                    const $li = document.createElement("li");
                    $li.innerHTML = `${el.name} -- ${el.email} -- ${el.phone}`
                    $fragment.appendChild($li)
                });

                $fetch.appendChild($fragment)

            })
            .catch((err) =>{
                //console.log(err)
                let mensaje = err.statusText || "Ocurrió un error";
                $fetch.innerHTML = `Error ${err.status}: ${mensaje}`
            })



        /* **********     Callbacks   **********
    
            function cuadradoCallback(value, callback){
                setTimeout(()=>{
                    callback(value, value * value)
                }, 0 | Math.random() * 1000)
            } 
    
            cuadradoCallback(0, (value, result) =>{
                console.log(`Callback: ${value}, ${result}`)
                cuadradoCallback(1, (value, result) =>{
                    console.log(`Callback: ${value}, ${result}`)
                    cuadradoCallback(2, (value, result) =>{
                        console.log(`Callback: ${value}, ${result}`)
                        cuadradoCallback(3, (value, result) =>{
                            console.log(`Callback: ${value}, ${result}`)
                        });
                    });
                });
            });
    
    
            console.log("este código no tiene tiene que esperarse a que termine el cuadrado ")
    */





        /* **********    Promesas      ********** 
        
                function cuadradoPromise(value){
                    if(typeof value !== "number"){
                        return Promise.reject(`Error, el valor "${value}" ingresado no es un número `)
                    }
        
                    return new Promise((resolve, reject) => {
                        setTimeout(()=>{
                           resolve({
                            value,
                            result: value * value
                           });
                        }, 0 | Math.random() * 1000);
         
                    });
                }
        
        
                cuadradoPromise(0)
                .then(obj =>{
                    console.log(`Promesa: ${obj.value}, ${obj.result}`);
                    return cuadradoPromise(1)
                })
                .then(obj =>{
                    console.log(`Promesa: ${obj.value}, ${obj.result}`);
                    return cuadradoPromise(2)
                })
                .then(obj =>{
                    console.log(`Promesa: ${obj.value}, ${obj.result}`);
                    return cuadradoPromise(3)
                })
                .then(obj =>{
                    console.log(`Promesa: ${obj.value}, ${obj.result}`);
                    return cuadradoPromise(4)
                })
                .then(obj =>{
                    console.log(`Promesa: ${obj.value}, ${obj.result}`);
                })
                .catch(err => console.log(err));
        
        
                */

        /* **********      Async - Await     **********
   
        function cuadradoPromise(value){
           if(typeof value !== "number"){
               return Promise.reject(`Error, el valor "${value}" ingresado no es un número `)
           }
   
           return new Promise((resolve, reject) => {
               setTimeout(()=>{
                  resolve({
                   value,
                   result: value * value
                  });
               }, 0 | Math.random() * 1000);
   
           });
       }
   
       async function functionAsincDeclarada(){
           try{
               let obj = await cuadradoPromise(0);
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
               
               obj = await cuadradoPromise(1)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise("2")
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise(3)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise(4)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
           }
           catch (err){
               console.log(err)
           } 
       }
   
       functionAsincDeclarada();
   
       
   
       function cuadradoPromise(value){
           if(typeof value !== "number"){
               return Promise.reject(`Error, el valor "${value}" ingresado no es un número `)
           }
   
           return new Promise((resolve, reject) => {
               setTimeout(()=>{
                  resolve({
                   value,
                   result: value * value
                  });
               }, 0 | Math.random() * 1000);
   
           });
       }
   
      const functionAsincExpresada = async () => {
           try{
               let obj = await cuadradoPromise(0);
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
               
               obj = await cuadradoPromise(1)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise(2)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise(3)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
               obj = await cuadradoPromise(4)
               console.log(`Async funtion: ${obj.value}, ${obj.result}`);
   
           }
           catch (err){
               console.log(err)
           } 
       }
   
       functionAsincExpresada();
   
       */








    </script>
</body>

</html>